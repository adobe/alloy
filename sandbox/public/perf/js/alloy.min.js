/**
 * Copyright 2019 Adobe. All rights reserved.
 * This file is licensed to you under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License. You may obtain a copy
 * of the License at http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under
 * the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS
 * OF ANY KIND, either express or implied. See the License for the specific language
 * governing permissions and limitations under the License.
 */

"use strict";document.documentMode&&document.documentMode<11?console.warn("The Adobe Experience Cloud Web SDK does not support IE 10 and below."):function(){var e="Chrome",n="Edge",t="EdgeChromium",r="Unknown",o=function(e,n){return-1!==e.indexOf(n)},i=[e,n,t,"IE",r],a=function(e){return o(i,e)},c=Object.getOwnPropertySymbols,u=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable;function f(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}var d=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var n={},t=0;t<10;t++)n["_"+String.fromCharCode(t)]=t;if("0123456789"!==Object.getOwnPropertyNames(n).map((function(e){return n[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(e,n){for(var t,r,o=f(e),i=1;i<arguments.length;i++){for(var a in t=Object(arguments[i]))u.call(t,a)&&(o[a]=t[a]);if(c){r=c(t);for(var d=0;d<r.length;d++)s.call(t,r[d])&&(o[r[d]]=t[r[d]])}}return o},l=function(e){return JSON.parse(JSON.stringify(e))},g="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function p(e,n){return e(n={exports:{}},n.exports),n.exports}var v=p((function(e,n){var t;t=function(){function e(){for(var e=0,n={};e<arguments.length;e++){var t=arguments[e];for(var r in t)n[r]=t[r]}return n}return function n(t){function r(n,o,i){var a;if("undefined"!=typeof document){if(arguments.length>1){if("number"==typeof(i=e({path:"/"},r.defaults,i)).expires){var c=new Date;c.setMilliseconds(c.getMilliseconds()+864e5*i.expires),i.expires=c}i.expires=i.expires?i.expires.toUTCString():"";try{a=JSON.stringify(o),/^[\{\[]/.test(a)&&(o=a)}catch(e){}o=t.write?t.write(o,n):encodeURIComponent(String(o)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),n=(n=(n=encodeURIComponent(String(n))).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent)).replace(/[\(\)]/g,escape);var u="";for(var s in i)i[s]&&(u+="; "+s,!0!==i[s]&&(u+="="+i[s]));return document.cookie=n+"="+o+u}n||(a={});for(var f=document.cookie?document.cookie.split("; "):[],d=/(%[0-9A-Z]{2})+/g,l=0;l<f.length;l++){var g=f[l].split("="),p=g.slice(1).join("=");'"'===p.charAt(0)&&(p=p.slice(1,-1));try{var v=g[0].replace(d,decodeURIComponent);if(p=t.read?t.read(p,v):t(p,v)||p.replace(d,decodeURIComponent),this.json)try{p=JSON.parse(p)}catch(e){}if(n===v){a=p;break}n||(a[v]=p)}catch(e){}}return a}}return r.set=r,r.get=function(e){return r.call(r,e)},r.getJSON=function(){return r.apply({json:!0},[].slice.call(arguments))},r.defaults={},r.remove=function(n,t){r(n,"",e(t,{expires:-1}))},r.withConverter=n,r}((function(){}))},e.exports=t()})),m={get:v.get,set:v.set,remove:v.remove},h=function(e){return null==e};function y(e){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function w(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function b(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function C(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?b(t,!0).forEach((function(n){w(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):b(t).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function E(e,n){if(null==e)return{};var t,r,o=function(e,n){if(null==e)return{};var t,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}function I(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){if(!(Symbol.iterator in Object(e))&&"[object Arguments]"!==Object.prototype.toString.call(e))return;var t=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(t.push(a.value),!n||t.length!==n);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return t}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function k(e){return function(e){if(Array.isArray(e)){for(var n=0,t=new Array(e.length);n<e.length;n++)t[n]=e[n];return t}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var O=function(e){return!h(e)&&!Array.isArray(e)&&"object"===y(e)},R=function e(n,t){Object.keys(t).forEach((function(r){O(n[r])&&O(t[r])?e(n[r],t[r]):n[r]=t[r]}))},S=function(e){if(h(e))throw new TypeError('deepAssign "target" cannot be null or undefined');for(var n=Object(e),t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];return r.forEach((function(e){return R(n,Object(e))})),n},D=function(e,n){return function(t){var r=n.split(".").reduce((function(e,n){return e[n]=e[n]||{},e[n]}),e);S(r,t)}},x=function(){var e=[];return{add:function(n){e.push(n)},call:function(){for(var n=arguments.length,t=new Array(n),r=0;r<n;r++)t[r]=arguments[r];return Promise.all(e.map((function(e){return e.apply(void 0,t)})))}}},P=function(){var e={};return e.promise=new Promise((function(n,t){e.resolve=n,e.reject=t})),e},q=function(e,n){for(var t=0;t<e.length;t+=1){var r=e[t];if(n(r,t,e))return r}},j=function(e,n){return e.appendChild(n)},N=function(e,n){Object.keys(n).forEach((function(t){if("style"===t&&O(n[t])){var r=n[t];Object.keys(r).forEach((function(n){e.style[n]=r[n]}))}else e[t]=n[t]}))},M=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:document,i=o.createElement(e);return Object.keys(n).forEach((function(e){i.setAttribute(e,n[e])})),N(i,t),r.forEach((function(e){return j(i,e)})),i},A="IMG",T="STYLE",F="SCRIPT",U="src",B=function(e){var n=e.src,t=e.currentDocument,r=void 0===t?document:t;return new Promise((function(e,t){M(A,{src:n},{onload:e,onerror:t,onabort:t},[],r)}))},_=function(e){return"function"==typeof e},V=function(e){return Array.isArray(e)&&e.length>0},L=function(e){return Array.isArray(e)?e:null==e?[]:[].slice.call(e)},z=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document;return L(n.querySelectorAll(e))},H={childList:!0,subtree:!0},J=function(e){return new Error("Could not find: "+e)},Q=function(e){return new Promise(e)},W=function(e){return _(e.MutationObserver)},X=function(e,n,t,r,o){return Q((function(i,a){var c=new e.MutationObserver((function(){var e=o(t);V(e)&&(c.disconnect(),i(e))}));setTimeout((function(){c.disconnect(),a(J(t))}),r),c.observe(n,H)}))},G=function(e){return"visible"===e.visibilityState},$=function(e,n,t,r){return Q((function(o,i){!function t(){var i=r(n);V(i)?o(i):e.requestAnimationFrame(t)}(),setTimeout((function(){i(J(n))}),t)}))},K=function(e,n,t){return Q((function(r,o){!function n(){var o=t(e);V(o)?r(o):setTimeout(n,100)}(),setTimeout((function(){o(J(e))}),n)}))},Y=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:z,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5e3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:window,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:document,i=n(e);return V(i)?Promise.resolve(i):W(r)?X(r,o,e,t,n):G(o)?$(r,e,t,n):K(e,t,n)},Z=function(e){var n=e.parentNode;return n?n.removeChild(e):null},ee=B,ne={name:"Adobe Alloy"},te={style:{display:"none",width:0,height:0}},re=function(e){var n,t=e.hideReferrer,r=e.url;return t?(n={src:r}.src,Y("BODY").then((function(e){var n=I(e,1)[0],t=M("IFRAME",ne,te);return j(n,t)})).then((function(e){var t=e.contentWindow.document;return B({src:n,currentDocument:t}).then((function(){Z(e)}))}))):ee({src:r})},oe=function(e,n){return Array.prototype.concat.apply([],e.map(n))},ie="com.adobe.alloy.",ae=ie+"getTld",ce=function(e,n){for(var t,r,o="",i=e.location.hostname.toLowerCase().split("."),a=1;a<i.length&&!n.get(ae);)o=(t=i,r=a+=1,t.slice(-r)).join("."),n.set(ae,ae,{domain:o});return n.remove(ae,{domain:o}),o},ue=function(e){return e.replace("@","_")},se=function(e,n){return"kndctr_"+ue(e)+"_"+n},fe=function(e,n){return e.filter((function(e){return o(n,e)}))},de=function(e){return O(e)&&0===Object.keys(e).length},le=function(e){return"number"==typeof e&&!isNaN(e)},ge=function(e){return"string"==typeof e},pe=function(e){return ge(e)&&e.length>0},ve=function(){},me=function(e,n,t){var r=String(e),o=String(t);if(r.length>=n||0===o.length)return r;for(var i=n-r.length;i>o.length;)o+=o;return o.slice(0,i)+r};function he(e,n){return Object.prototype.hasOwnProperty.call(e,n)}for(var ye=function(e,n,t,r){n=n||"&",t=t||"=";var o={};if("string"!=typeof e||0===e.length)return o;var i=/\+/g;e=e.split(n);var a=1e3;r&&"number"==typeof r.maxKeys&&(a=r.maxKeys);var c=e.length;a>0&&c>a&&(c=a);for(var u=0;u<c;++u){var s,f,d,l,g=e[u].replace(i,"%20"),p=g.indexOf(t);p>=0?(s=g.substr(0,p),f=g.substr(p+1)):(s=g,f=""),d=decodeURIComponent(s),l=decodeURIComponent(f),he(o,d)?Array.isArray(o[d])?o[d].push(l):o[d]=[o[d],l]:o[d]=l}return o},we=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}},be=function(e,n,t,r){return n=n||"&",t=t||"=",null===e&&(e=void 0),"object"==typeof e?Object.keys(e).map((function(r){var o=encodeURIComponent(we(r))+t;return Array.isArray(e[r])?e[r].map((function(e){return o+encodeURIComponent(we(e))})).join(n):o+encodeURIComponent(we(e[r]))})).join(n):r?encodeURIComponent(we(r))+t+encodeURIComponent(we(e)):""},Ce=p((function(e,n){n.decode=n.parse=ye,n.encode=n.stringify=be})),Ee=(Ce.decode,Ce.parse,Ce.encode,Ce.stringify,function(e){return"string"==typeof e&&(e=e.trim().replace(/^[?#&]/,"")),Ce.parse(e)}),Ie=function(e){return e instanceof Error?e:new Error(e)},ke=function(e){var n=e.error,t=e.message;try{n.message=t}catch(e){}},Oe=function(e){var n=e.error,t=e.message,r=Ie(n),o=t+"\nCaused by: "+r.message;return ke({error:r,message:o}),r},Re=function(e,n,t){return{getItem:function(r){try{return e[n].getItem(t+r)}catch(e){return null}},setItem:function(r,o){try{return e[n].setItem(t+r,o),!0}catch(e){return!1}}}},Se=function(e){var n=e.getFullYear(),t=me(e.getMonth()+1,2,"0"),r=me(e.getDate(),2,"0"),o=me(e.getHours(),2,"0"),i=me(e.getMinutes(),2,"0"),a=me(e.getSeconds(),2,"0"),c=me(e.getMilliseconds(),3,"0"),u=e.getTimezoneOffset();return n+"-"+t+"-"+r+"T"+o+":"+i+":"+a+"."+c+(u>0?"-":"+")+me(Math.floor(Math.abs(u)/60),2,"0")+":"+me(Math.abs(u)%60,2,"0")},De=p((function(e){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var t=new Uint8Array(16);e.exports=function(){return n(t),t}}else{var r=new Array(16);e.exports=function(){for(var e,n=0;n<16;n++)0==(3&n)&&(e=4294967296*Math.random()),r[n]=e>>>((3&n)<<3)&255;return r}}})),xe=[],Pe=0;Pe<256;++Pe)xe[Pe]=(Pe+256).toString(16).substr(1);var qe=function(e,n){var t=n||0,r=xe;return[r[e[t++]],r[e[t++]],r[e[t++]],r[e[t++]],"-",r[e[t++]],r[e[t++]],"-",r[e[t++]],r[e[t++]],"-",r[e[t++]],r[e[t++]],"-",r[e[t++]],r[e[t++]],r[e[t++]],r[e[t++]],r[e[t++]],r[e[t++]]].join("")};var je=function(e,n,t){var r=n&&t||0;"string"==typeof e&&(n="binary"===e?new Array(16):null,e=null);var o=(e=e||{}).random||(e.rng||De)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,n)for(var i=0;i<16;++i)n[r+i]=o[i];return n||qe(o)},Ne=function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=function(t,r){return n(e(t,r),r)};return d(r,e,t),r},Me=function(e,n,t){return Ne(e,(function(e,t){return null==e?e:n(e,t)}),t)},Ae=function(e,n,t,r){if(!e)throw new Error("'"+t+"': Expected "+r+", but got "+JSON.stringify(n)+".")},Te=function(e,n){return Ae(function(e){return"boolean"==typeof e}(e),e,n,"true or false"),e},Fe=function(e,n){return Ae(_(e),e,n,"a function"),e},Ue=function(e,n){return function(t,r){return Ae(t>=n,t,r,e+" greater than or equal to "+n),t}},Be=function(e){return function(n,t){return O(n)?Ae(!de(n),n,t,e):Ae(n.length>0,n,t,e),n}},_e=/^[a-z0-9.-]{1,}$/i,Ve=function(e,n){return Ae(_e.test(e),e,n,"a valid domain"),e},Le=function(e,n){return Ae(function(e){var n=parseInt(e,10);return le(n)&&e===n}(e),e,n,"an integer"),e},ze=function(e,n){return Ae(le(e),e,n,"a number"),e},He=function(e,n){return Ae(function(e){try{return null!==new RegExp(e)}catch(e){return!1}}(e),e,n,"a regular expression"),e},Je=function(e,n){if(null==e)throw new Error("'"+n+"' is a required option");return e},Qe=function(e,n){return Ae(ge(e),e,n,"a string"),e},We=function(e){return e};We.default=function(e){return Ne(this,function(e){return function(n){return null==n?e:n}}(e))},We.required=function(){return Ne(this,Je)};var Xe=function(){return Me(this,Ve)},Ge=function(e){return Me(this,Ue("an integer",e))},$e=function(e){return Me(this,Ue("a number",e))},Ke=function(){return Me(this,Le,{minimum:Ge})},Ye=function(){return Me(this,Be("a non-empty string"))},Ze=function(){return Me(this,Be("a non-empty array"))},en=function(){return Me(this,Be("a non-empty object"))},nn=function(){return Me(this,He)},tn=function(){return Me(this,function(){var e=[];return function(n,t){return Ae(-1===e.indexOf(n),n,t,"a unique value across instances"),e.push(n),n}}())},rn=function(e,n){return Ne(this,function(e,n){return function(t,r){var o=q(e,(function(e){try{return e(t,r),!0}catch(e){return!1}}));return Ae(o,t,r,n),t}}(e,n))}.bind(We),on=function(){return Me(this,We)}.bind(We),an=function(e){return Me(this,function(e){return function(n,t){Ae(Array.isArray(n),n,t,"an array");var r=[],o=n.map((function(n,o){try{return e(n,t+"["+o+"]")}catch(e){return void r.push(e.message)}}));if(r.length)throw new Error(r.join("\n"));return o}}(e),{nonEmpty:Ze})}.bind(We),cn=function(){return Me(this,Te)}.bind(We),un=function(){return Me(this,Fe)}.bind(We),sn=function(e){return Me(this,function(e){return function(n,t){return Ae(n===e,n,t,""+e),n}}(e))}.bind(We),fn=(function(){return Me(this,ze,{minimum:$e,integer:Ke,unique:tn})}.bind(We),function(e){return Me(this,(n=e,function(e,t){Ae(O(e),e,t,"an object");var r=[],o={};if(Object.keys(e).forEach((function(i){var a=e[i],c=t?t+"."+i:i;try{var u=n(a,c);void 0!==u&&(o[i]=u)}catch(e){r.push(e.message)}})),r.length)throw new Error(r.join("\n"));return o}),{nonEmpty:en});var n}.bind(We)),dn=function(e){return Me(this,function(e){return function(n,t){Ae(O(n),n,t,"an object");var r=[],o={};if(Object.keys(e).forEach((function(i){var a=n[i],c=e[i],u=t?t+"."+i:i;try{var s=c(a,u);void 0!==s&&(o[i]=s)}catch(e){r.push(e.message)}})),Object.keys(n).forEach((function(e){Object.prototype.hasOwnProperty.call(o,e)||(o[e]=n[e])})),r.length)throw new Error(r.join("\n"));return o}}(e),{noUnknownFields:function(){return Me(this,function(e){return function(n,t){var r=[];if(Object.keys(n).forEach((function(n){if(!e[n]){var o=t?t+"."+n:n;r.push("'"+o+"': Unknown field.")}})),r.length)throw new Error(r.join("\n"));return n}}(e))},nonEmpty:en})}.bind(We),ln=function(){return Me(this,Qe,{regexp:nn,domain:Xe,nonEmpty:Ye,unique:tn})}.bind(We),gn=function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return rn(n.map(sn),"one of these values: ["+JSON.stringify(n)+"]")},pn=fn(an(dn({authenticatedState:gn("ambiguous","authenticated","loggedOut"),id:ln(),namespace:dn({code:ln()}).noUnknownFields(),primary:cn(),xid:ln()})).required()),vn=function(e){var n,t=e.console,r=e.locationSearch,o=e.createLogger,i=e.instanceName,a=e.createNamespacedStorage,c=e.getMonitors,u=Ee(r),s=a("instance."+i+"."),f=s.session.getItem("debug"),d="true"===f,l=null===f,g=function(){return d},p=function(e,n){var t=n.fromConfig;t&&!l||(d=e),t||(s.session.setItem("debug",e.toString()),l=!1)};return void 0!==u.alloy_debug&&p((n=u.alloy_debug,ge(n)&&"true"===n.toLowerCase()),{fromConfig:!1}),{setDebugEnabled:p,logger:o({getDebugEnabled:g,context:{instanceName:i},getMonitors:c,console:t}),createComponentLogger:function(e){return o({getDebugEnabled:g,context:{instanceName:i,componentName:e},getMonitors:c,console:t})}}},mn=["onComponentsRegistered","onBeforeEvent","onBeforeDataCollectionRequest","onBeforeRequest","onResponse","onRequestFailure","onClick"],hn=function(e){return mn.reduce((function(n,t){var r;return n[t]=(r=function(e,n){return function(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return Promise.all(e.getLifecycleCallbacks(n).map((function(e){return new Promise((function(n){n(e.apply(void 0,r))}))})))}}(e,t),function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return Promise.resolve().then((function(){return r.apply(void 0,n)}))}),n}),{})},yn=function(e,n){return function(){var t;try{t=e.apply(void 0,arguments)}catch(e){throw Oe({error:e,message:n})}return t instanceof Promise&&(t=t.catch((function(e){throw Oe({error:e,message:n})}))),t}},wn=function(){var e={},n={};return{register:function(t,r){var o=r.commands,i=r.lifecycle;!function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=fe(Object.keys(e),Object.keys(t));if(r.length)throw new Error("[ComponentRegistry] Could not register "+n+" because it has existing command(s): "+r.join(","));Object.keys(t).forEach((function(r){var o=t[r];o.commandName=r,o.run=yn(o.run,"["+n+"] An error occurred while executing the "+r+" command."),e[r]=o}))}(t,o),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object.keys(t).forEach((function(r){n[r]=n[r]||[],n[r].push(yn(t[r],"["+e+"] An error occurred while executing the "+r+" lifecycle hook."))}))}(t,i)},getCommand:function(n){return e[n]},getCommandNames:function(){return Object.keys(e)},getLifecycleCallbacks:function(e){return n[e]||[]}}},bn="The user declined consent.",Cn="declinedConsent",En=function(){var e=new Error(bn);return e.code=Cn,e},In=function(){var e=[],n=function(){return Promise.resolve()},t=function(){return Promise.reject(En())},r=function(){var n=P();return e.push(n),n.promise};return{in:function(){!function(){for(;e.length;)e.shift().resolve()}(),this.awaitConsent=n},out:function(){!function(){for(;e.length;)e.shift().reject(En())}(),this.awaitConsent=t},pending:function(){this.awaitConsent=r},awaitConsent:r}},kn="in",On="pending",Rn="general",Sn=function(){var e,n,t,r={},o=!1,i={setUserXdm:function(n){e=n},setUserData:function(e){n=e},mergeXdm:D(r,"xdm"),mergeMeta:D(r,"meta"),mergeQuery:D(r,"query"),documentMayUnload:function(){o=!0},getDocumentMayUnload:function(){return o},isEmpty:function(){return de(r)&&(!e||de(e))&&(!n||de(n))},setLastChanceCallback:function(e){t=e},getViewName:function(){if(e&&e.web&&e.web.webPageDetails)return e.web.webPageDetails.viewName},toJSON:function(){if(e&&i.mergeXdm(e),n&&(r.data=n),t){var o=l(r.xdm||{}),a=l(r.data||{});try{t({xdm:o,data:a}),!r.xdm&&de(o)||(r.xdm=o),!r.data&&de(a)||(r.data=a)}catch(e){}}return r}};return i},Dn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.handle,t=void 0===n?[]:n,r=e.errors,o=void 0===r?[]:r,i=e.warnings,a=void 0===i?[]:i;return{getPayloadsByType:function(e){return oe(t.filter((function(n){return n.type===e})),(function(e){return e.payload}))},getErrors:function(){return o},getWarnings:function(){return a},toJSON:function(){return e}}},xn={CONFIGURE:"configure",SET_DEBUG:"setDebug"},Pn=function(e){var n,t=e.logger,r=e.configureCommand,o=e.setDebugCommand,i=e.handleError,a=e.validateCommandOptions,c=function(e,i){var c;if(e===xn.CONFIGURE){if(n)throw new Error("The library has already been configured and may only be configured once.");c=function(){return n=r(i)}}else{if(!n)throw new Error("The library must be configured first. Please do so by executing the configure command.");c=e===xn.SET_DEBUG?function(){return o(i)}:function(){return n.then((function(n){var t,r=n.getCommand(e);if(!r||!_(r.run)){var o=(t=xn,Object.keys(t).map((function(e){return t[e]}))).concat(n.getCommandNames()).join(", ");throw new Error("The "+e+" command does not exist. List of available commands: "+o+".")}var c=a({command:r,options:i});return r.run(c)}),(function(){return t.warn("An error during configuration is preventing the "+e+" command from executing."),new Promise((function(){}))}))}}return c};return function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((function(r){var o=c(e,n);t.logOnBeforeCommand({commandName:e,options:n}),r(o())})).then((function(e){return O(e)?e:{}})).catch((function(n){return i(n,e+" command")}))}},qn=function(e){var n=e.command,t=e.options,r=n.commandName,o=n.documentationUri,i=void 0===o?"https://adobe.ly/2UH0qO7":o,a=n.optionsValidator,c=t;if(a)try{c=a(t)}catch(e){throw new Error("Invalid "+r+" command options:\n\t - "+e+" For command documentation see: "+i)}return c},jn=function(e){var n=e.eventManager,t=e.logger;return{commands:{sendEvent:{documentationUri:"https://adobe.ly/2r0uUjh",optionsValidator:function(e){return function(e){var n=e.options,t=e.logger,r=dn({type:ln(),xdm:dn({eventType:ln(),identityMap:pn}),data:dn({}),renderDecisions:cn(),decisionScopes:an(ln()),datasetId:ln()}).required()(n),o=r.type,i=r.xdm;return!i||i.eventType||o||t.warn("No type or xdm.eventType specified."),r}({options:e,logger:t})},run:function(e){var t=e.xdm,r=e.data,o=e.documentUnloading,i=void 0!==o&&o,a=e.type,c=e.mergeId,u=e.renderDecisions,s=void 0!==u&&u,f=e.decisionScopes,d=void 0===f?[]:f,l=e.datasetId,g=n.createEvent();return i&&g.documentMayUnload(),g.setUserXdm(t),g.setUserData(r),a&&g.mergeXdm({eventType:a}),c&&g.mergeXdm({eventMergeId:c}),l&&g.mergeMeta({collect:{datasetId:l}}),n.sendEvent(g,{renderDecisions:s,decisionScopes:d})}}}}};jn.namespace="DataCollector",jn.configValidators={};var Nn=function(e){var n=e.config,t=e.eventManager,r=e.lifecycle,o=e.handleError;if(n.clickCollectionEnabled){var i=function(e){var n=e.eventManager,t=e.lifecycle,r=e.handleError;return function(e){var o=e.target,i=n.createEvent();return t.onClick({event:i,clickedElement:o}).then((function(){return i.isEmpty()?Promise.resolve():n.sendEvent(i)})).then(ve).catch((function(e){r(e,"click collection")}))}}({eventManager:t,lifecycle:r,handleError:o});document.addEventListener("click",i,!0)}},Mn={clickCollectionEnabled:cn().default(!0),downloadLinkQualifier:ln().regexp().default("\\.(exe|zip|wav|mp3|mov|mpg|avi|wmv|pdf|doc|docx|xls|xlsx|ppt|pptx)$")},An=function(e,n,t,r){var o="other";return!function(e,n,t){var r=new RegExp(e);return!!t.download||r.test(n.toLowerCase())}(n.downloadLinkQualifier,t,r)?function(e,n){var t=e.location.hostname.toLowerCase();return!(n.toLowerCase().indexOf(t)>=0)}(e,t)&&(o="exit"):o="download",o},Tn=function(e){var n=e.config,t=e.eventManager,r=e.handleError,o=function(e,n){return function(t,r){var o=function(e){for(var n,t=e;t;){if((n=t).href&&("A"===n.tagName||"AREA"===n.tagName)&&(!n.onclick||!n.protocol||n.protocol.toLowerCase().indexOf("javascript")<0))return t;t=t.parentNode}return null}(r);if(o){var i=function(e,n){var t=e.location,r=n.href?n.href:"",o=n.protocol,i=n.host;if(!function(e){return e&&/^[a-z0-9]+:\/\//i.test(e)}(r)){o||(o=t.protocol?t.protocol:""),o=o?o+"//":"",i||(i=t.host?t.host:"");var a="";if("/"!==r.substring(0,1)){var c=t.pathname.lastIndexOf("/");c=c<0?0:c,a=t.pathname.substring(0,c)}r=""+o+i+a+"/"+r}return r}(e,o);if(i){var a=An(e,n,i,o);t.documentMayUnload(),t.mergeXdm({eventType:"web.webinteraction.linkClicks",web:{webInteraction:{name:"Link Click",type:a,URL:i,linkClicks:{value:1}}}})}}}}(window,n);return{lifecycle:{onComponentsRegistered:function(e){var o=e.lifecycle;Nn({config:n,eventManager:t,lifecycle:o,handleError:r})},onClick:function(e){var n=e.event,t=e.clickedElement;o(n,t)}}}};Tn.namespace="ActivityCollector",Tn.configValidators=Mn;var Fn,Un,Bn,_n=function(e,n){return"ID sync "+(n?"succeeded":"failed")+": "+e.spec.url},Vn={thirdPartyCookiesEnabled:cn().default(!0),idMigrationEnabled:cn().default(!0)},Ln=function(e){return dn({namespaces:an(sn("ECID")).nonEmpty()}).noUnknownFields()(e),{namespaces:["ECID"]}},zn=ce(window,m),Hn=function(e){var n=e.config,t=e.getEcidFromVisitor,r=n.idMigrationEnabled,o="AMCV_"+n.orgId;return{getEcid:function(){if(r){var e=function(){var e=null,n=m.get("s_ecid")||m.get(o);if(n){var t=n.match(/(^|\|)MCMID\|(\d+)($|\|)/);t&&(e=t[2])}return e}();return e?Promise.resolve(e):t()}return Promise.resolve()},setEcid:function(e){r&&!m.get(o)&&m.set(o,"MCMID|"+e,{domain:zn,expires:390})}}},Jn=function(e){var n=e.logger;return new Promise((function(e,t){if(O(window.adobe)&&O(window.adobe.optIn)){var r=window.adobe.optIn;n.log("Delaying request while waiting for legacy opt-in to let Visitor retrieve ECID from server."),r.fetchPermissions((function(){r.isApproved([r.Categories.ECID])?(n.log("Received legacy opt-in approval to let Visitor retrieve ECID from server."),e()):t(new Error("Legacy opt-in was declined."))}),!0)}else e()}))},Qn=function(e){var n=e.logger,t=e.orgId,r=e.awaitVisitorOptIn,o=function(e){var n=e.Visitor;return _(n)&&_(n.getInstance)&&n}(window);return function(){return o?r({logger:n}).then((function(){return n.log("Delaying request while using Visitor to retrieve ECID from server."),new Promise((function(e){o.getInstance(t,{}).getMarketingCloudVisitorID((function(t){n.log("Resuming previously delayed request that was waiting for ECID from Visitor."),e(t)}),!0)}))})).catch((function(e){e?n.log(e.message+", retrieving ECID from experience edge"):n.log("An error occurred while obtaining the ECID from Visitor.")})):Promise.resolve()}},Wn="ECID",Xn=function(e){e.mergeQuery({identity:{fetch:[Wn]}})},Gn=(Fn=function(o){var i,a;return(w(i={},n,/Edge\/([0-9\._]+)/),w(i,t,/Edg\/([0-9\.]+)/),w(i,e,/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/),w(i,"Firefox",/Firefox\/([0-9\.]+)(?:\s|$)/),w(i,"IE",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/),w(i,"Safari",/Version\/([0-9\._]+).*Safari/),a=i,function(e){for(var n=Object.keys(a),t=0;t<n.length;t+=1){var o=n[t];if(a[o].test(e))return o}return r})(o.navigator.userAgent)},Bn=new Map,function(){var e=Un?Un.apply(void 0,arguments):arguments.length<=0?void 0:arguments[0];if(Bn.has(e))return Bn.get(e);var n=Fn.apply(void 0,arguments);return Bn.set(e,n),n}),$n=function(e,n){e.addIdentity(Wn,{id:n})},Kn=function(e){var n=e.getPayloadsByType("identity:result"),t=q(n,(function(e){return e.namespace&&e.namespace.code===Wn}));return t?t.id:void 0},Yn=function(e){var n={},t=!1,r={mergeConfigOverrides:D(n,"meta.configOverrides"),mergeState:D(n,"meta.state"),mergeQuery:D(n,"query"),useIdThirdPartyDomain:function(){t=!0},getUseIdThirdPartyDomain:function(){return t},addIdentity:function(){},getDocumentMayUnload:function(){return!1},toJSON:function(){return n}},o=e(n);return d({},r,o)},Zn=function(e){return function(n,t){e.xdm=e.xdm||{},e.xdm.identityMap=e.xdm.identityMap||{},e.xdm.identityMap[n]=e.xdm.identityMap[n]||[],e.xdm.identityMap[n].push(t)}},et=function(e){return Yn((function(n){return n.query=n.query||{},n.query.identity={fetch:e},{addIdentity:Zn(n)}}))},nt=function(e){var n=e.config,t=e.logger,r=e.consent,o=e.sendEdgeNetworkRequest,i=n.orgId,c=n.thirdPartyCookiesEnabled,u=Qn({logger:t,orgId:i,awaitVisitorOptIn:Jn}),s=Hn({config:n,getEcidFromVisitor:u}),f=function(e){var n=e.orgId,t=se(n,"identity");return function(){return Boolean(m.get(t))}}({orgId:i}),d=function(e){var n=e.sendEdgeNetworkRequest,t=e.createIdentityPayload;return function(e){return n({payload:t(e),action:"identity/acquire"})}}({sendEdgeNetworkRequest:o,createIdentityPayload:et}),l=function(e){var n=e.thirdPartyCookiesEnabled,t=e.areThirdPartyCookiesSupportedByDefault;return function(e){n&&t(Gn(window))&&e.useIdThirdPartyDomain()}}({thirdPartyCookiesEnabled:c,areThirdPartyCookiesSupportedByDefault:a}),g=function(e){var n=e.getLegacyEcid,t=e.addEcidToPayload;return function(e){return n().then((function(n){n&&t(e,n)}))}}({getLegacyEcid:s.getEcid,addEcidToPayload:$n}),p=function(e){var n=e.orgId,t=e.doesIdentityCookieExist;return function(e){var r=e.onResponse,o=e.onRequestFailure;return new Promise((function(e,i){r((function(){if(!t()){var r=new Error("An identity was not set properly. Please verify that the org ID "+n+" configured in Alloy matches the org ID specified in the edge configuration.");throw i(r),r}e()})),o((function(){t()?e():i(new Error("No identity was set on response."))}))}))}}({orgId:i,doesIdentityCookieExist:f}),v=function(e){var n,t=e.doesIdentityCookieExist,r=e.setDomainForInitialIdentityPayload,o=e.addLegacyEcidToPayload,i=e.awaitIdentityCookie,a=e.logger,c=function(e){return r(e),o(e)};return function(e){var r=e.payload,o=e.onResponse,u=e.onRequestFailure;if(t())return Promise.resolve();if(n){a.log("Delaying request while retrieving ECID from server.");var s=n;return n=s.catch((function(){return i({onResponse:o,onRequestFailure:u})})),s.then((function(){a.log("Resuming previously delayed request.")})).catch((function(){return c(r)}))}return n=i({onResponse:o,onRequestFailure:u}),c(r)}}({doesIdentityCookieExist:f,setDomainForInitialIdentityPayload:l,addLegacyEcidToPayload:g,awaitIdentityCookie:p,logger:t}),h=function(e){var n=e.processIdSyncs;return function(e){return n(e.getPayloadsByType("identity:exchange"))}}({processIdSyncs:function(e){var n=e.fireReferrerHideableImage,t=e.logger;return function(e){var r=e.filter((function(e){return"url"===e.type}));return r.length?Promise.all(r.map((function(e){return n(e.spec).then((function(){t.log(_n(e,!0))})).catch((function(){t.error(_n(e,!1))}))}))).then(ve):Promise.resolve()}}({fireReferrerHideableImage:re,logger:t})});return function(e){var n,t=e.addEcidQueryToPayload,r=e.ensureSingleIdentity,o=e.setLegacyEcid,i=e.handleResponseForIdSyncs,a=e.getEcidFromResponse,c=e.getIdentity,u=e.consent;return{lifecycle:{onBeforeRequest:function(e){var n=e.payload,o=e.onResponse,i=e.onRequestFailure;return t(n),r({payload:n,onResponse:o,onRequestFailure:i})},onResponse:function(e){var t=e.response;return n||(n=a(t))&&o(n),i(t)}},commands:{getIdentity:{optionsValidator:Ln,run:function(e){return u.awaitConsent().then((function(){return n?void 0:c(e.namespaces)})).then((function(){return{identity:{ECID:n}}}))}}}}}({ensureSingleIdentity:v,addEcidQueryToPayload:Xn,setLegacyEcid:s.setEcid,handleResponseForIdSyncs:h,getEcidFromResponse:Kn,getIdentity:d,consent:r})};nt.namespace="Identity",nt.configValidators=Vn;var tt=function(e,n){return"URL destination "+(n?"succeeded":"failed")+": "+e.spec.url},rt=function(e){var n=e.fireReferrerHideableImage,t=e.logger;return function(e){return function(e){e.filter((function(e){return"cookie"===e.type})).forEach((function(e){var n=e.spec,t=n.name,r=n.value,o=n.domain,i=n.ttlDays;m.set(t,r||"",{domain:o||"",expires:i||10})}))}(e),function(e,n,t){var r=t.filter((function(e){return"url"===e.type}));return Promise.all(r.map((function(t){return e(t.spec).then((function(){n.log(tt(t,!0))})).catch((function(){n.error(tt(t,!1))}))}))).then(ve)}(n,t,e)}},ot=function(e){var n=e.logger,t=rt({fireReferrerHideableImage:re,logger:n}),r=function(e){var n=e.response;if(n){var r=n.getPayloadsByType("activation:push");return t(r)}};return{lifecycle:{onResponse:r,onRequestFailure:r},commands:{}}};ot.namespace="Audiences",ot.configValidators={};var it,at="__view__",ct="https://ns.adobe.com/personalization/dom-action",ut=function(e){var n=e.logger,t=e.fetchDataHandler,r=e.viewChangeHandler,i=e.onClickHandler,a=e.isAuthoringModeEnabled,c=e.mergeQuery,u=e.viewCache;return{lifecycle:{onBeforeEvent:function(e){var i=e.event,s=e.renderDecisions,f=e.decisionScopes,d=void 0===f?[]:f,l=e.onResponse,g=void 0===l?ve:l,p=e.onRequestFailure,v=void 0===p?ve:p;if(a())return n.warn("Rendering is disabled, authoring mode."),void c(i,{enabled:!1});var m=function(e){var n=e.renderDecisions,t=e.decisionScopes,r=e.event,i=e.viewCache,a=r.getViewName();return{isRenderDecisions:function(){return n},getViewName:function(){return a},hasScopes:function(){return t.length>0},hasViewName:function(){return void 0!==a},createQueryDetails:function(){var e=k(t);this.isCacheInitialized()||o(e,at)||e.push(at);var n=["https://ns.adobe.com/personalization/html-content-item","https://ns.adobe.com/personalization/json-content-item","https://ns.adobe.com/personalization/redirect-item"];return o(e,at)&&n.push(ct),{schemas:n,decisionScopes:e}},isCacheInitialized:function(){return i.isInitialized()},shouldFetchData:function(){return this.hasScopes()||!this.isCacheInitialized()},shouldUseCachedData:function(){return this.hasViewName()&&this.isCacheInitialized()}}}({renderDecisions:s,decisionScopes:d,event:i,viewCache:u});if(m.shouldFetchData()){var h=P();return u.storeViews(h.promise),void t({decisionsDeferred:h,personalizationDetails:m,event:i,onResponse:g,onRequestFailure:v})}m.shouldUseCachedData()&&r({personalizationDetails:m,onResponse:g,onRequestFailure:v})},onClick:function(e){var n=e.event,t=e.clickedElement;i({event:n,clickedElement:t})}}}},st=function(e){return M("DIV",{},{innerHTML:e})},ft=p((function(e,n){var t;t=g,e.exports=function(e){if(e.CSS&&e.CSS.escape)return e.CSS.escape;var n=function(e){if(0==arguments.length)throw new TypeError("`CSS.escape` requires an argument.");for(var n,t=String(e),r=t.length,o=-1,i="",a=t.charCodeAt(0);++o<r;)0!=(n=t.charCodeAt(o))?i+=n>=1&&n<=31||127==n||0==o&&n>=48&&n<=57||1==o&&n>=48&&n<=57&&45==a?"\\"+n.toString(16)+" ":0==o&&1==r&&45==n||!(n>=128||45==n||95==n||n>=48&&n<=57||n>=65&&n<=90||n>=97&&n<=122)?"\\"+t.charAt(o):t.charAt(o):i+="ï¿½";return i};return e.CSS||(e.CSS={}),e.CSS.escape=n,n}(t)})),dt=/:eq\((\d+)\)/g,lt=function(e){return-1===e.indexOf(":eq(")},gt=/(#|\.)(-?\w+)/g,pt=/^\s*>?\s*/,vt=function(e,n,t){return""+n+ft(t)},mt=function(e){for(var n=[],t=function(e){return e.split(dt).filter(pe)}(function(e){return e.replace(gt,vt)}(e.trim())),r=t.length,o=0;o<r;){var i=t[o].replace(pt,"").trim(),a=t[o+1];a?n.push({sel:i,eq:Number(a)}):n.push({sel:i}),o+=2}return n},ht=function(e){var n=document;if(lt(e))return z(e,n);for(var t=mt(e),r=t.length,o=[],i=n,a=0;a<r;){var c=t[a],u=c.sel,s=c.eq,f=z(u,i),d=f.length;if(0===d)break;if(null!=s&&s>d-1)break;if(a<r-1)if(null==s)i=I(f,1)[0];else i=f[s];a===r-1&&(o=null==s?f:[f[s]]),a+=1}return o},yt=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document;return n.getElementById(e)},wt=function(e,n,t){e.setAttribute(n,t)},bt=function(e,n){return e.getAttribute(n)},Ct=function(e){return e.parentNode},Et=function(e,n){if(e){var t=Ct(e);t&&t.insertBefore(n,function(e){return e.nextElementSibling}(e))}},It=function(e,n){if(e){var t=Ct(e);t&&t.insertBefore(n,e)}},kt=function(e){var n=e.childNodes;return n?L(n):[]},Ot=function(e){return e.firstElementChild},Rt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;if(void 0===it){var n=e.querySelector("[nonce]");it=n&&(n.nonce||n.getAttribute("nonce"))}return it},St="alloy-prehiding",Dt={},xt=function(e){var n=Dt[e];n&&(Z(n),delete Dt[e])},Pt=function(e){if(e&&!yt(St)){var n=Rt(),t=C({id:St},n&&{nonce:n}),r=M(T,t,{textContent:e});j(document.head,r)}},qt=function(){var e=yt(St);e&&Z(e)},jt=function(e,n){e.textContent=n},Nt=function(e){return M(A,{src:e})},Mt=function(e){z(A,e).forEach((function(e){var n=bt(e,U);n&&Nt(n)}))},At=function(e){return function(e,n){return e.tagName===n}(e,T)&&!bt(e,U)},Tt=function(e){var n=z(T,e),t=n.length,r=Rt();if(r)for(var o=0;o<t;o+=1){var i=n[o];At(i)&&(i.nonce=r)}};var Ft=setTimeout;function Ut(e){return Boolean(e&&void 0!==e.length)}function Bt(){}function _t(e){if(!(this instanceof _t))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],Qt(e,this)}function Vt(e,n){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,_t._immediateFn((function(){var t=1===e._state?n.onFulfilled:n.onRejected;if(null!==t){var r;try{r=t(e._value)}catch(e){return void zt(n.promise,e)}Lt(n.promise,r)}else(1===e._state?Lt:zt)(n.promise,e._value)}))):e._deferreds.push(n)}function Lt(e,n){try{if(n===e)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"==typeof n||"function"==typeof n)){var t=n.then;if(n instanceof _t)return e._state=3,e._value=n,void Ht(e);if("function"==typeof t)return void Qt(function(e,n){return function(){e.apply(n,arguments)}}(t,n),e)}e._state=1,e._value=n,Ht(e)}catch(n){zt(e,n)}}function zt(e,n){e._state=2,e._value=n,Ht(e)}function Ht(e){2===e._state&&0===e._deferreds.length&&_t._immediateFn((function(){e._handled||_t._unhandledRejectionFn(e._value)}));for(var n=0,t=e._deferreds.length;n<t;n++)Vt(e,e._deferreds[n]);e._deferreds=null}function Jt(e,n,t){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof n?n:null,this.promise=t}function Qt(e,n){var t=!1;try{e((function(e){t||(t=!0,Lt(n,e))}),(function(e){t||(t=!0,zt(n,e))}))}catch(e){if(t)return;t=!0,zt(n,e)}}_t.prototype.catch=function(e){return this.then(null,e)},_t.prototype.then=function(e,n){var t=new this.constructor(Bt);return Vt(this,new Jt(e,n,t)),t},_t.prototype.finally=function(e){var n=this.constructor;return this.then((function(t){return n.resolve(e()).then((function(){return t}))}),(function(t){return n.resolve(e()).then((function(){return n.reject(t)}))}))},_t.all=function(e){return new _t((function(n,t){if(!Ut(e))return t(new TypeError("Promise.all accepts an array"));var r=Array.prototype.slice.call(e);if(0===r.length)return n([]);var o=r.length;function i(e,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var c=a.then;if("function"==typeof c)return void c.call(a,(function(n){i(e,n)}),t)}r[e]=a,0==--o&&n(r)}catch(e){t(e)}}for(var a=0;a<r.length;a++)i(a,r[a])}))},_t.resolve=function(e){return e&&"object"==typeof e&&e.constructor===_t?e:new _t((function(n){n(e)}))},_t.reject=function(e){return new _t((function(n,t){t(e)}))},_t.race=function(e){return new _t((function(n,t){if(!Ut(e))return t(new TypeError("Promise.race accepts an array"));for(var r=0,o=e.length;r<o;r++)_t.resolve(e[r]).then(n,t)}))},_t._immediateFn="function"==typeof setImmediate&&function(e){setImmediate(e)}||function(e){Ft(e,0)},_t._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)};var Wt="undefined"!=typeof window&&window.Promise||void 0!==g&&g.Promise||_t.default||_t,Xt=function(e){var n=document.createElement("script");n.src=e,n.async=!0;var t=function(e,n){return new Wt((function(t,r){n.onload=function(){t(n)},n.onerror=function(){r(new Error("Failed to load script "+e))}}))}(e,n);return document.getElementsByTagName("head")[0].appendChild(n),t},Gt=function(e,n){return e.tagName===n},$t=function(e){return Gt(e,F)&&!bt(e,U)},Kt=function(e){return Gt(e,F)&&bt(e,U)},Yt=function(e){for(var n=z(F,e),t=[],r=n.length,o=Rt(),i=C({},o&&{nonce:o}),a=0;a<r;a+=1){var c=n[a];if($t(c)){var u=c.textContent;u&&t.push(M(F,i,{textContent:u}))}}return t},Zt=function(e){for(var n=z(F,e),t=[],r=n.length,o=0;o<r;o+=1){var i=n[o];if(Kt(i)){var a=bt(i,U);a&&t.push(a)}}return t},er=function(e,n,t){n.forEach((function(n){return t(e,n)}))},nr=function(e){return Promise.all(e.map(Xt))},tr=function(e,n){var t=st(n);Tt(t);var r=kt(t),o=Yt(t),i=Zt(t);return Mt(t),r.forEach((function(n){j(e,n)})),er(e,o,j),nr(i)},rr=function(e,n){!function(e){kt(e).forEach(Z)}(e),tr(e,n)},or=function(e,n){var t=st(n);Tt(t);var r=kt(t),o=Yt(t),i=Zt(t),a=r.length-1;for(Mt(t);a>=0;){var c=r[a],u=Ot(e);u?It(u,c):j(e,c),a-=1}return er(e,o,j),nr(i)},ir=function(e,n){var t=st(n);Tt(t);var r=kt(t),o=Yt(t),i=Zt(t);return Mt(t),r.forEach((function(n){It(e,n)})),er(e,o,It),nr(i)},ar=function(e,n){ir(e,n),Z(e)},cr=function(e,n){var t=st(n);Tt(t);var r=kt(t),o=Yt(t),i=Zt(t);return Mt(t),r.forEach((function(n){Et(e,n)})),er(e,o,Et),nr(i)},ur=function(e,n){var t=n.priority,r=E(n,["priority"]);Object.keys(r).forEach((function(n){!function(e,n,t,r){var o;o=r?n+":"+t+" !"+r+";":n+":"+t+";",e.style.cssText+=";"+o}(e,n,r[n],t)}))},sr=function(e,n){Object.keys(n).forEach((function(t){wt(e,t,n[t])}))},fr=function(e,n){e.tagName===A&&(Nt(n),function(e,n){e.removeAttribute(n)}(e,U),wt(e,U,n))},dr=function(e,n){var t=n.from,r=n.to,o=function(e){var n=e.children;return n?L(n):[]}(e),i=o[t],a=o[r];i&&a&&(t<r?Et(a,i):It(a,i))},lr=function(e){return function(n){var t=n.selector,r=n.prehidingSelector,o=n.content,i=n.meta;return function(e){if(!Dt[e]){var n=Rt(),t=C({},n&&{nonce:n}),r=M(T,t,{textContent:e+" { visibility: hidden }"});j(document.head,r),Dt[e]=r}}(r),Y(t,ht).then((function(n){return function(e,n,t){var r=e.map((function(e){return t(e,n)}));return Promise.all(r)}(n,o,e)})).then((function(){return xt(r),{meta:i}}),(function(e){return xt(r),{meta:i,error:e}}))}},gr=function(e){return{setHtml:lr(rr),customCode:lr(or),setText:lr(jt),setAttribute:lr(sr),setImageSource:lr(fr),setStyle:lr(ur),move:lr(ur),resize:lr(ur),rearrange:lr(dr),remove:lr(Z),insertAfter:lr(cr),insertBefore:lr(ir),replaceHtml:lr(ar),prependHtml:lr(or),appendHtml:lr(tr),click:function(n){return function(e,n){return n({selector:e.selector,meta:e.meta}),Promise.resolve()}(n,e)}}},pr=function(e,n,t){if(e.enabled){var r=JSON.stringify(n),o=t.message,i=t.stack,a="Failed to execute action "+r+". "+o+" "+(i?"\n "+i:"");e.error(a)}},vr=function(e,n,t){var r=e.map((function(e){var r=e.type;return function(e,n,t,r){var o=n[t];if(!o){var i=new Error('DOM action "'+t+'" not found');throw pr(e,r[0],i),i}return o.apply(void 0,k(r))}(t,n,r,[e]).then((function(n){return function(e,n){if(e.enabled){var t=JSON.stringify(n);e.log("Action "+t+" executed.")}}(t,e),n})).catch((function(n){throw pr(t,e,n),n}))}));return Promise.all(r)},mr=function(e){return e},hr=function(e){var n=e.modules,t=e.logger,r=e.executeActions,o=e.collect;return function(e){var i=e.map((function(e){var o=function(e){var n={id:e.id,scope:e.scope};return e.items.map((function(e){return d({},e.data,{meta:n})}))}(e);return r(o,n,t)}));return Promise.all(i).then((function(e){return function(e,n,t){var r=oe(t,mr),o=[],i=new Set;r.forEach((function(e){if(e)if(e.error)n.warn(e);else{var t=e.meta;i.has(t.id)||(i.add(t.id),o.push(t))}})),V(o)&&e({meta:{decisions:o}})}(o,t,e)})).catch((function(e){t.error(e)}))}},yr=function(e,n){if(lt(e))return function(e,n){return n.matches?n.matches(e):n.msMatchesSelector(e)}(e,n);for(var t=ht(e),r=!1,o=0;o<t.length;o+=1)if(t[o]===n){r=!0;break}return r},wr=function(e,n){for(var t=document.documentElement,r=n.selector,o=n.meta,i=e;i&&i!==t;){if(yr(r,i))return o;i=i.parentNode}return null},br=function(e,n){if(0===n.length)return[];for(var t=[],r=0;r<n.length;r+=1){var o=wr(e,n[r]);o&&t.push(o)}return t},Cr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return-1!==e.location.href.indexOf("mboxEdit")},Er=function(e,n){e.mergeMeta({personalization:C({},n)})},Ir=function(e,n){e.mergeQuery({personalization:C({},n)})},kr=function(e,n){return{id:e.id,scope:e.scope,items:n}},Or={groupDecisionsBySchema:function(e){return function(e,n){var t=[],r=[];return e.forEach((function(e){var o=e.items,i=I(function(e,n){var t=[],r=[];return e.forEach((function(e){e.schema===n?t.push(e):r.push(e)})),[t,r]}(void 0===o?[]:o,n),2),a=i[0],c=i[1];V(a)&&t.push(kr(e,a)),V(c)&&r.push(kr(e,c))})),{domActionDecisions:t,nonDomActionDecisions:r}}(e.decisions,e.schema)},groupDecisionsByScope:function(e){return function(e,n){var t=[],r={};return V(e)&&e.forEach((function(e){e.scope===n?t.push(e):(r[e.scope]||(r[e.scope]=[]),r[e.scope].push(e))})),{pageWideScopeDecisions:t,nonPageWideScopeDecisions:r}}(e.decisions,e.scope)}},Rr=function(e){var n,t,r=e.config,o=e.logger,i=e.eventManager,a=function(e){var n=e.eventManager,t=e.mergeMeta;return function(e){var r=e.meta,o=n.createEvent();return o.mergeXdm({eventType:"display"}),t(o,r),n.sendEvent(o)}}({eventManager:i,mergeMeta:Er}),c=function(e){var n=e.eventManager,t=e.mergeMeta;return function(e){var r=e.meta,o=e.xdm,i=void 0===o?{}:o,a=r.decisions,c=void 0===a?[]:a,u={eventType:"display"},s=n.createEvent();if(V(c)){var f=c[0].scope;u.web={webPageDetails:{viewName:f}},t(s,r)}return s.mergeXdm(u),s.mergeXdm(i),n.sendEvent(s)}}({eventManager:i,mergeMeta:Er}),u=[],s=(t=P(),{storeViews:function(e){e.then((function(e){void 0===n&&(n={}),d(n,e),t.resolve()}))},getView:function(e){return t.promise.then((function(){return n[e]}))},isInitialized:function(){return!(void 0===n)}}),f=gr((function(e){return u.push(e)})),l=hr({modules:f,logger:o,executeActions:vr,collect:a}),g=function(e){var n=e.viewCache,t=e.executeViewDecisions,r=e.collect;return function(e){var o=e.viewName;n.getView(o).then((function(e){V(e)?t(e):r({meta:{},xdm:{web:{webPageDetails:{viewName:o}}}})}))}}({viewCache:s,executeViewDecisions:hr({modules:f,logger:o,executeActions:vr,collect:c}),collect:c}),p=function(e){var n=e.config,t=e.responseHandler,r=e.showContainers,o=e.hideContainers,i=e.mergeQuery;return function(e){var a=e.decisionsDeferred,c=e.personalizationDetails,u=e.event,s=e.onResponse,f=e.onRequestFailure,d=n.prehidingStyle;c.isRenderDecisions()&&o(d),i(u,c.createQueryDetails()),s((function(e){var n=e.response;return t({decisionsDeferred:a,personalizationDetails:c,response:n})})),f((function(){a.reject(),r()}))}}({config:r,responseHandler:function(e){var n=e.decisionsExtractor,t=e.executeDecisions,r=e.executeCachedViewDecisions,o=e.showContainers;return function(e){var i=e.decisionsDeferred,a=e.personalizationDetails,c=e.response.getPayloadsByType("personalization:decisions"),u=a.getViewName();if(0===c.length)return o(),i.resolve({}),{decisions:[]};var s=n.groupDecisionsBySchema({decisions:c,schema:ct}),f=s.domActionDecisions,d=s.nonDomActionDecisions,l=n.groupDecisionsByScope({decisions:f,scope:at}),g=l.pageWideScopeDecisions,p=l.nonPageWideScopeDecisions;if(de(p)?i.resolve({}):i.resolve(p),a.isRenderDecisions())return t(g),u&&r({viewName:u}),o(),{decisions:d};var v=[].concat(k(g),k(d));return u&&p[u]&&v.push.apply(v,k(p[u])),{decisions:v}}}({decisionsExtractor:Or,executeDecisions:l,executeCachedViewDecisions:g,showContainers:qt}),showContainers:qt,hideContainers:Pt,mergeQuery:Ir}),v=function(e){var n=e.mergeMeta,t=e.collectClicks,r=e.clickStorage;return function(e){var o=e.event,i=e.clickedElement,a=t(i,r);V(a)&&(o.mergeXdm({eventType:"click"}),n(o,{decisions:a}))}}({mergeMeta:Er,collectClicks:br,clickStorage:u}),m=function(e){var n=e.executeCachedViewDecisions,t=e.viewCache,r=e.showContainers;return function(e){var o=e.personalizationDetails,i=e.onResponse,a=e.onRequestFailure,c=o.getViewName();o.isRenderDecisions()?n({viewName:c}):(i((function(){return t.getView(c).then((function(e){return{decisions:e}}))})),a((function(){r()})))}}({executeCachedViewDecisions:g,viewCache:s,showContainers:qt});return ut({logger:o,fetchDataHandler:p,viewChangeHandler:m,onClickHandler:v,isAuthoringModeEnabled:Cr,mergeQuery:Ir,viewCache:s})};Rr.namespace="Personalization",Rr.configValidators={prehidingStyle:ln().nonEmpty()};var Sr,Dr="2.3.0",xr=function(e){return function(n){var t={webPageDetails:{URL:e.location.href||e.location},webReferrer:{URL:e.document.referrer}};S(n,{web:t})}}(window),Pr=function(e){return function(n){var t=e.screen,r=t.width,o={screenHeight:t.height,screenWidth:r},i=function(e){var n=e.screen.orientation;if(null==n||null==n.type)return null;var t=n.type.split("-");return 0===t.length||"portrait"!==t[0]&&"landscape"!==t[0]?null:t[0]}(e)||function(e){return e.matchMedia("(orientation: portrait)").matches?"portrait":e.matchMedia("(orientation: landscape)").matches?"landscape":null}(e);i&&(o.screenOrientation=i),S(n,{device:o})}}(window),qr=function(e){return function(n){var t=e.innerWidth,r=e.innerHeight;S(n,{environment:{type:"browser",browserDetails:{viewportWidth:t,viewportHeight:r}}})}}(window),jr=(Sr=function(){return new Date},function(e){var n=Sr(),t={localTime:Se(n),localTimezoneOffset:n.getTimezoneOffset()};S(e,{placeContext:t})}),Nr=function(e){return function(n){var t=e().toISOString();S(n,{timestamp:t})}}((function(){return new Date})),Mr=function(e){return function(n){S(n,{implementationDetails:e})}}({name:"https://ns.adobe.com/experience/alloy",version:Dr,environment:"browser"}),Ar={web:xr,device:Pr,environment:qr,placeContext:jr},Tr=[Nr,Mr],Fr=function(e){return function(e,n,t,r){var o=e.context,i=oe(o,(function(e,r){return t[e]?[t[e]]:(n.warn("Invalid context["+r+"]: '"+e+"' is not available."),[])})).concat(r);return{namespace:"Context",lifecycle:{onBeforeEvent:function(e){var n=e.event,t={};i.forEach((function(e){return e(t)})),n.mergeXdm(t)}}}}(e.config,e.logger,Ar,Tr)};Fr.namespace="Context",Fr.configValidators={context:an(ln()).default(Object.keys(Ar))};var Ur=function(){return Yn((function(e){return{addIdentity:function(n,t){e.identityMap=e.identityMap||{},e.identityMap[n]=e.identityMap[n]||[],e.identityMap[n].push(t)},setConsent:function(n){e.consent=n}}}))},Br=function(e){return e.split(";").reduce((function(e,n){var t=I(n.split("="),2),r=t[0],o=t[1];return e[r]=o,e}),{})},_r=dn({consent:an(on()).required().nonEmpty(),identityMap:pn}).noUnknownFields().required(),Vr=function(e){var n,t,r=e.config,o=e.consent,i=e.sendEdgeNetworkRequest,a=r.orgId,c=r.defaultConsent;return function(e){var n=e.readStoredConsent,t=e.taskQueue,r=e.defaultConsent,o=e.consent,i=e.sendSetConsentRequest,a=e.validateSetConsentOptions,c=d(w({},Rn,r),n());o.setConsent(c);var u=function(){if(0===t.length){var e=n();e&&o.setConsent(e)}};return{commands:{setConsent:{optionsValidator:a,run:function(e){var n=e.consent,r=e.identityMap;return o.suspend(),t.addTask((function(){return i({consentOptions:n,identityMap:r})})).catch((function(e){throw u(),e})).then(u)}}},lifecycle:{onResponse:u,onRequestFailure:u}}}({readStoredConsent:function(e){var n=e.parseConsentCookie,t=e.orgId,r=e.cookieJar,o=se(t,"consent");return function(){var e=r.get(o);return e?n(e):void 0}}({parseConsentCookie:Br,orgId:a,cookieJar:m}),taskQueue:(n=0,t=Promise.resolve(),{addTask:function(e){n+=1;var r=function(){return e().finally((function(){n-=1}))};return t=t.then(r,r)},get length(){return n}}),defaultConsent:c,consent:o,sendSetConsentRequest:function(e){var n=e.createConsentRequestPayload,t=e.sendEdgeNetworkRequest;return function(e){var r=e.consentOptions,o=e.identityMap,i=n();return i.setConsent(r),O(o)&&Object.keys(o).forEach((function(e){o[e].forEach((function(n){i.addIdentity(e,n)}))})),t({payload:i,action:"privacy/set-consent"}).then((function(){}))}}({createConsentRequestPayload:Ur,sendEdgeNetworkRequest:i}),validateSetConsentOptions:_r})};Vr.namespace="Privacy";var Lr=function(){return{eventMergeId:je()}},zr=function(e){e.config;return{commands:{createEventMergeId:{run:Lr}}}};zr.namespace="EventMerge",zr.configValidators={};var Hr=function(){return{commands:{getLibraryInfo:{run:function(){return{libraryInfo:{version:Dr}}}}}}};Hr.namespace="LibraryInfo";var Jr,Qr=[jn,Tn,nt,ot,Rr,Fr,Vr,zr,Hr],Wr=function(e){var n=e.options,t=e.componentCreators,r=e.coreConfigValidators,o=e.createConfig,i=e.logger,a=e.setDebugEnabled,c=o(function(e,n){try{return dn(e).noUnknownFields().required()(n)}catch(e){throw new Error("Resolve these configuration problems:\n\t - "+e.message.split("\n").join("\n\t - ")+"\nFor configuration documentation see: https://adobe.ly/2M4ErNE")}}(function(e,n){var t={};return d(t,e),n.forEach((function(e){var n=e.configValidators;d(t,n)})),t}(r,t),n));return a(c.debugEnabled,{fromConfig:!0}),i.logOnInstanceConfigured({config:c}),c},Xr=function(e){return d({},e)},Gr=function(e){var n=e.errorPrefix,t=e.logger;return function(e,r){var o=Ie(e);if(o.code===Cn)return t.warn("The "+r+" could not fully complete because the user declined consent."),{};throw ke({error:o,message:n+" "+o.message}),o}},$r=function(e){var n,t=e.window,r=e.logger,o=_(t.fetch)?function(e){return function(n,t){return e(n,{method:"POST",cache:"no-cache",credentials:"include",headers:{"Content-Type":"text/plain; charset=UTF-8"},referrer:"client",body:t}).then((function(e){return e.text().then((function(n){return{status:e.status,body:n}}))}))}}(t.fetch):(n=t.XMLHttpRequest,function(e,t){return new Promise((function(r,o){var i=new n;i.onreadystatechange=function(){4===i.readyState&&(0===i.status?o(new Error("Request aborted.")):r({status:i.status,body:i.responseText}))},i.onloadstart=function(){i.responseType="text"},i.open("POST",e,!0),i.setRequestHeader("Content-Type","text/plain; charset=UTF-8"),i.withCredentials=!0,i.onerror=o,i.onabort=o,i.send(t)}))}),i=t.navigator&&_(t.navigator.sendBeacon)?function(e,n,t){return function(r,o){var i=new Blob([o],{type:"text/plain; charset=UTF-8"});return e.sendBeacon(r,i)?Promise.resolve({status:204,body:""}):(t.log("The `beacon` call has failed; falling back to `fetch`"),n(r,o))}}(t.navigator,o,r):o;return function(e){var n=e.url,t=e.body;return(e.documentMayUnload?i:o)(n,t)}},Kr=function(e){var n=e.getDebugEnabled,t=e.console,r=e.getMonitors,o=e.context,i="["+o.instanceName+"]";o.componentName&&(i+=" ["+o.componentName+"]");var a=function(e,n){var t=r();if(t.length>0){var i=d({},o,n);t.forEach((function(n){n[e]&&n[e](i)}))}},c=function(e){for(var r=arguments.length,o=new Array(r>1?r-1:0),c=1;c<r;c++)o[c-1]=arguments[c];a("onBeforeLog",{level:e,arguments:o}),n()&&t[e].apply(t,[i].concat(o))};return{get enabled(){return r().length>0||n()},logOnInstanceCreated:function(e){a("onInstanceCreated",e),c("info","Instance initialized.")},logOnInstanceConfigured:function(e){a("onInstanceConfigured",e),c("info","Instance configured. Computed configuration:",e.config)},logOnBeforeCommand:function(e){a("onBeforeCommand",e),c("info","Executing "+e.commandName+" command. Options:",e.options)},logOnBeforeNetworkRequest:function(e){a("onBeforeNetworkRequest",e),c("info","Request "+e.requestId+": Sending request.",e.payload)},logOnNetworkResponse:function(e){a("onNetworkResponse",e);var n=e.parsedBody||e.body?"response body:":"no response body.";c("info","Request "+e.requestId+": Received response with status code "+e.status+" and "+n,e.parsedBody||e.body)},logOnNetworkError:function(e){a("onNetworkError",e),c("error","Request "+e.requestId+": Network request failed.",e.error)},log:c.bind(null,"log"),info:c.bind(null,"info"),warn:c.bind(null,"warn"),error:c.bind(null,"error")}},Yr=function(e){var n=e.cookieJar,t=e.orgId,r=e.apexDomain;return{cookiesToPayload:function(e,o){var i,a=(i=r,o.substr(-i.length)===i),c={domain:r,cookiesEnabled:!0};if(!a){var u=n.get(),s=Object.keys(u).filter((function(e){return function(e,n){return 0===n.indexOf("kndctr_"+ue(e)+"_")}(t,e)})).map((function(e){return{key:e,value:u[e]}}));s.length&&(c.entries=s)}e.mergeState(c)},responseToCookies:function(e){e.getPayloadsByType("state:store").forEach((function(e){var t,o,i,a={domain:r};void 0!==e.maxAge&&(a.expires=(t=1e3,o=864e5,i=e.maxAge,t*i/o)),n.set(e.key,e.value,a)}))}}},Zr=function(){return Yn((function(e){return{addIdentity:Zn(e),addEvent:function(n){e.events=e.events||[],e.events.push(n)},getDocumentMayUnload:function(){return(e.events||[]).some((function(e){return e.getDocumentMayUnload()}))}}}))},eo=function(e){var n=e.statusCode,t=e.body,r=e.parsedBody;if(!r&&204!==n||r&&!Array.isArray(r.handle))throw new Error("Unexpected server response with status code "+n+" and "+(t?"response body: "+t:"no response body."))},no=function(e){return 429===e||e>=500&&e<600},to=window.__alloyNS,ro=(Jr=window,function(e){var n=ie+e;return{session:Re(Jr,"sessionStorage",n),persistent:Re(Jr,"localStorage",n)}}),oo=window.console,io=function(){return window.__alloyMonitors||[]},ao={debugEnabled:cn().default(!1),defaultConsent:gn(kn,On).default(kn),edgeConfigId:ln().unique().required(),edgeDomain:ln().domain().default("edge.adobedc.net"),edgeBasePath:ln().nonEmpty().default("ee"),orgId:ln().unique().required(),onBeforeEventSend:un().default(ve)},co=ce(window,m);to&&to.forEach((function(e){var n=vn({console:oo,locationSearch:window.location.search,createLogger:Kr,instanceName:e,createNamespacedStorage:ro,getMonitors:io}),t=n.setDebugEnabled,r=n.logger,o=n.createComponentLogger,i=wn(),a=hn(i),c=$r({window:window,logger:r}),u=Gr({errorPrefix:"["+e+"]",logger:r}),s=function(e){return function(n){var t=n[0],r=n[1],o=n[2],i=o[0],a=o[1];e(i,a).then(t,r)}}(Pn({logger:r,configureCommand:function(n){var u=Wr({options:n,componentCreators:Qr,coreConfigValidators:ao,createConfig:Xr,logger:r,setDebugEnabled:t}),s=Yr({cookieJar:m,orgId:u.orgId,apexDomain:co}),f=function(e){var n=e.logger,t=e.networkStrategy,r=e.isRetryableHttpStatusCode;return function(e){var o=e.payload,i=e.url,a=e.requestId,c=JSON.stringify(o);return n.enabled&&n.logOnBeforeNetworkRequest({url:i,requestId:a,payload:JSON.parse(c)}),function e(){var u=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return t({url:i,body:c,documentMayUnload:o.getDocumentMayUnload()}).then((function(t){if(r(t.status)&&u<3)return e(u+1);var o;try{o=JSON.parse(t.body)}catch(e){}return n.logOnNetworkResponse(C({requestId:a,url:i,payload:JSON.parse(c)},t,{parsedBody:o,retriesAttempted:u})),{statusCode:t.status,body:t.body,parsedBody:o}}))}().catch((function(e){throw n.logOnNetworkError({requestId:a,url:i,payload:JSON.parse(c),error:e}),Oe({error:e,message:"Network request failed."})}))}}({logger:r,networkStrategy:c,isRetryableHttpStatusCode:no}),l=function(e){var n=e.logger;return function(e){var t=e.getWarnings(),r=e.getErrors();if(t.forEach((function(e){n.warn("Warning received from server: [Code "+e.code+"] "+e.message)})),r.length){var o=r.reduce((function(e,n){return e+"\nâ€¢ [Code "+n.code+"] "+n.message}),"The server responded with the following errors:");throw new Error(o)}}}({logger:r}),g=function(e){var n=e.config,t=e.lifecycle,r=e.cookieTransfer,o=e.sendNetworkRequest,i=e.createResponse,a=e.processWarningsAndErrors,c=e.validateNetworkResponseIsWellFormed,u=n.edgeDomain,s=n.edgeBasePath,f=n.edgeConfigId;return function(e){var n=e.payload,l=e.action,g=e.runOnResponseCallbacks,p=void 0===g?ve:g,v=e.runOnRequestFailureCallbacks,m=void 0===v?ve:v,h=x();h.add(t.onResponse),h.add(p);var y=x();return y.add(t.onRequestFailure),y.add(m),t.onBeforeRequest({payload:n,onResponse:h.add,onRequestFailure:y.add}).then((function(){var e=n.getUseIdThirdPartyDomain()?"adobedc.demdex.net":u,t=je(),i="https://"+e+"/"+s+"/v1/"+l+"?configId="+f+"&requestId="+t;return r.cookiesToPayload(n,e),o({payload:n,url:i,requestId:t})})).then((function(e){return c(e),e})).catch((function(e){var n=function(){throw e};return y.call({error:e}).then(n,n)})).then((function(e){var n=e.parsedBody,t=e.statusCode,o=i(n);if(r.responseToCookies(o),t>=400){var c=function(){return a(o)};return y.call({response:o}).then(c,c)}return h.call({response:o}).then((function(e){a(o);var n=e.shift()||[],t=e.shift()||[],r=e;return d.apply(void 0,[{}].concat(k(n),k(t),k(r)))}))}))}}({config:u,lifecycle:a,cookieTransfer:s,sendNetworkRequest:f,createResponse:Dn,processWarningsAndErrors:l,validateNetworkResponseIsWellFormed:eo}),p=function(e){var n=e.generalConsentState,t=e.logger;return{setConsent:function(e){switch(e.general){case kn:n.in();break;case"out":t.warn("Some commands may fail. "+bn),n.out();break;case On:t.warn("Some commands may be delayed until the user consents."),n.pending();break;default:t.warn("Unknown consent value: "+e.general)}},suspend:function(){n.pending()},awaitConsent:function(){return n.awaitConsent()}}}({generalConsentState:In(),logger:r}),v=function(e){var n=e.config,t=e.logger,r=e.lifecycle,o=e.consent,i=e.createEvent,a=e.createDataCollectionRequestPayload,c=e.sendEdgeNetworkRequest,u=n.onBeforeEventSend,s=function(){try{u.apply(void 0,arguments)}catch(e){throw t.error(e),e}};return{createEvent:i,sendEvent:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.setLastChanceCallback(s);var t=n.renderDecisions,i=void 0!==t&&t,u=n.decisionScopes,f=a(),d=x(),l=x();return r.onBeforeEvent({event:e,renderDecisions:i,decisionScopes:u,payload:f,onResponse:d.add,onRequestFailure:l.add}).then((function(){return f.addEvent(e),o.awaitConsent()})).then((function(){return r.onBeforeDataCollectionRequest({payload:f,onResponse:d.add,onRequestFailure:l.add})})).then((function(){var n=e.getDocumentMayUnload();return c({payload:f,action:n?"collect":"interact",runOnResponseCallbacks:d.call,runOnRequestFailureCallbacks:l.call})}))}}}({config:u,logger:r,lifecycle:a,consent:p,createEvent:Sn,createDataCollectionRequestPayload:Zr,sendEdgeNetworkRequest:g});return function(e){var n=e.componentCreators,t=e.lifecycle,r=e.componentRegistry,o=e.getImmediatelyAvailableTools;return n.forEach((function(e){var n,t=e.namespace,i=o(t);try{n=e(i)}catch(e){throw Oe({error:e,message:"["+t+"] An error occurred during component creation."})}r.register(t,n)})),t.onComponentsRegistered({lifecycle:t}).then((function(){return r}))}({componentCreators:Qr,lifecycle:a,componentRegistry:i,getImmediatelyAvailableTools:function(n){var t=o(n);return{config:u,consent:p,eventManager:v,logger:t,lifecycle:a,sendEdgeNetworkRequest:g,handleError:Gr({errorPrefix:"["+e+"] ["+n+"]",logger:t})}}})},setDebugCommand:function(e){t(e.enabled,{fromConfig:!1})},handleError:u,validateCommandOptions:qn})),f=window[e].q;f.push=s,r.logOnInstanceCreated({instance:s}),f.forEach(s)}))}();
